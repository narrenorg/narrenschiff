- name: Deploy config map
  kubectl:
    command: apply
    args:
      # filename: "{{ files_path }}/configmap.yaml"
      filename: configmap.yaml  # relative paths must **not** start with /
      namespace: development

- name: Apply namespaces and RBAC settings
  kubectl:
    command: apply
    args:
      filename:
        - app/deployment.yaml
        - app/secret.yaml
      namespace: default

# In future
# - name: Apply namespaces and RBAC settings
#   kubectl:
#     command: apply
#     args:
#       filename: "examples/files/{{ item }}.yaml"
#   with_items:
#     - namespaces
#     - rbac

- name: Display pods in kube-system
  kubectl:
    command: get pods
    args:
      namespace: kube-system

- name: Deploy app
  kustomization: examples/files/app/
